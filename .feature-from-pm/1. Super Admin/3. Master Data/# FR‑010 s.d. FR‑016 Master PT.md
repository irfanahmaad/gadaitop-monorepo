# FR‑010 s.d. FR‑016 Master PT

## FR‑010 View Master PT List

**Feature Name:** View Master PT List  

### Description  
The system provides a “Master PT” page that lists all PT records (company entities) in a table, aligned with the Figma design: content header with title and “Tambah Data” button, and a scrollable table containing identity and contact information for each PT with an action menu per row.  

### Actor  
- Super Admin (Owner)  
- Super Admin  

### Priority  
High  

### Preconditions
- User is logged into CMS as Super Admin Owner or Super Admin with permission to access “Master PT”.  
- User navigates to the “Master PT” menu from the left sidebar under “Master Data”.  
- PT master data service/API is reachable.  

### Postconditions
- The system displays the latest list of PT records in a table matching the Figma layout (columns and actions).  
- Any subsequent navigation (e.g., from Create/Edit/Delete back to list) can restore the last known table state (page, search, selected rows) if supported by the implementation.  
- View access may be logged into audit trail (user, timestamp, action “VIEW_MASTER_PT”).  

### UI & Interaction Requirements

**Page Layout**
- Standard CMS layout:  
  - Left sidebar: logo “GADAI TOP”, menu items including “Dashboard”, “Master Data”, and active “Master PT”.  
  - Top bar: user profile on the top-right.  
- Content header:  
  - Title: “Master PT”.  
  - Optional breadcrumb: “Page / Master PT”.  
  - Primary button “+ Tambah Data” on the top-right to open the Create PT form (FR‑013).  

**Table Layout**
- Section title: “Daftar PT”.  
- Table columns (from left to right, mengikuti Figma):  
  1. Checkbox (for bulk selection).  
  2. Kode PT (unique PT code).  
  3. Nama PT.  
  4. Email PT.  
  5. No. Telepon PT.  
  6. Admin Primary (nama admin utama PT).  
  7. Action (three-dot menu).  
- Each row represents one PT and shows all above values plus a kebab Action menu.  
- Clicking any cell, including “Nama PT”, **does not** open detail; PT Detail is accessed only through the Action menu (see FR‑014).  
- Hover states:  
  - Row hover highlight (subtle background).  
  - Action menu icon hover state.  

**Empty, Loading, and Error States**
- Loading: skeleton rows or centered spinner in the table body.  
- Empty: message such as “Belum ada PT yang terdaftar” with optional “Tambah Data” shortcut.  
- Error: inline banner above table (“Tidak dapat memuat data PT. Coba lagi.”) plus “Coba Lagi” button.  

**Responsiveness**
- Desktop (≥1366 px): all columns visible without overlap.  
- Tablet / smaller widths:  
  - Less critical columns may truncate text with ellipsis and optional tooltip.  
  - Horizontal scroll is allowed; header stays aligned with body.  

### Data & Behavior Requirements
- On initial load, frontend calls API with: page (default 1), pageSize (default 10), sortBy (e.g., kodePt or namaPt), sortDirection.  
- Kode PT column is filled from backend’s unique PT code field.  
- Admin Primary column shows the name of the primary Admin PT associated with that PT, if available; if none, show “-”.  
- Checkboxes:  
  - Single checkbox in header selects/deselects all rows in the current page.  
  - Row checkbox toggles selection for that PT, used by bulk delete (FR‑016).  
- Action menu per row contains at least options: “Detail”, “Edit”, and “Delete”.  

### Security & Business Rules
- Only authorized roles may access Master PT; others are redirected or see access-denied.  
- User must only see PTs under their ownership/visibility according to business rules (e.g., per pemilik).  
- No sensitive non‑PT data (like user credentials) may be returned in PT list API.  

### Acceptance Criteria
- Authorized user opens “Master PT” and sees header, “+ Tambah Data” button, and PT list table with columns and styles matching Figma.  
- Clicking any cell in a row does nothing navigational; navigation only occurs via the Action menu.  
- Empty, loading, and error states display appropriate messages without breaking layout.  
- Row checkbox and header checkbox work for selection without reloading the page.  

---

## FR‑011 Pagination & Result Summary (Master PT)

**Feature Name:** Master PT Pagination  

### Description  
The system provides pagination controls and a results summary at the bottom of the “Daftar PT” table so users can navigate multiple pages of PT records.  

### Actor  
- Super Admin (Owner)  
- Super Admin  

### Priority  
Medium  

### Preconditions
- User is on the Master PT page.  
- Total number of PT records exceeds one page size.  

### Postconditions
- User can navigate across pages while keeping the table layout intact.  
- The “Showing X to Y of Z results” summary always matches backend data.  

### UI & Interaction Requirements

**Pagination Controls**
- Shown at the bottom-right of the table:  
  - “Previous” button.  
  - Page number buttons (1, 2, 3, …).  
  - “Next” button.  
- Active page is visually highlighted.  
- “Previous” disabled on first page; “Next” disabled on last page.  

**Result Summary**
- Shown at bottom-left: text like “Showing X to Y of Z results”.  
- X, Y, Z calculated from current page, pageSize, and total PT count.  

**Optional Page Size Selector**
- Optional dropdown to choose pageSize (e.g., 10, 25, 50).  

### Data & Behavior Requirements
- Page changes trigger API calls with updated `page` parameter, preserving any search filters.  
- Changing pageSize reloads data and resets page to 1.  
- Search/filter changes (FR‑012) reset pagination to page 1 and recalc summary.  

### Security & Business Rules
- Pagination must not allow access to PT entities outside user’s visibility scope.  
- Backend must enforce tenant or pemilik scoping on any paginated query.  

### Acceptance Criteria
- When PT count > pageSize, pagination and “Showing X to Y of Z results” appear with correct values.  
- Clicking page numbers or Next/Previous updates table data and active page without full reload.  
- Disabled states prevent users from navigating beyond first/last page without causing UI errors.  

---

## FR‑012 Search Master PT

**Feature Name:** Search PT  

### Description  
The system allows users to search/filter PT records in the “Master PT” table by Kode PT, Nama PT, email, or phone number to quickly find specific PTs.  

### Actor  
- Super Admin (Owner)  
- Super Admin  

### Priority  
High  

### Preconditions
- User is on “Master PT” page with at least one PT record.  
- Search input is rendered above or near the table according to design system.  

### Postconditions
- The table shows only PT rows that match the search criteria.  
- User can clear the search to restore the full PT list.  

### UI & Interaction Requirements
- Search field with placeholder like “Cari Kode PT, Nama PT, email atau nomor telepon”.  
- User types keyword and presses Enter or clicks search icon to apply filter.  
- Clear/reset control (icon or button) available to remove keyword and reload full list.  

### Data & Behavior Requirements
- Search performed server-side via API parameters; at minimum, keyword should be matched against:  
  - Kode PT  
  - Nama PT  
  - Email PT  
  - No. Telepon PT  
- When search active:  
  - Pagination resets to first page.  
  - Result summary shows values for filtered dataset.  
- If search returns zero results, table shows “PT tidak ditemukan untuk kata kunci ini.”  

### Security & Business Rules
- Search results are limited to PTs the user is authorized to see.  
- Search input must be sanitized to avoid injection attacks.  

### Acceptance Criteria
- Entering a keyword and triggering search filters the PT table correctly.  
- Zero matches show a clear “no results” state while preserving layout.  
- Clearing search restores the original list and pagination.  

---

## FR‑013 Create PT (Tambah Data PT)

**Feature Name:** Create PT  

### Description  
The system provides a “Tambah Data” form page for creating new PT entries, matching the Figma “Tambah Data / Data PT” layout, including PT identity and primary admin information.  

### Actor  
- Super Admin (Owner)  

### Priority  
High  

### Preconditions
- User is logged in as Super Admin Owner with permission to create PT.  
- User is on the Master PT page and clicks “+ Tambah Data”.  

### Postconditions
- A new PT record is created and stored with all required fields.  
- The new PT appears in the Master PT list according to current sort and filters.  

### UI & Interaction Requirements

**Navigation**
- Clicking “+ Tambah Data” navigates to the “Tambah Data” page.  
- Breadcrumb/subtitle shows “Tambah Data / Master PT”.  

**Form Layout**
- Section title: “Data PT”.  
- Layout (based on Figma):  
  - Left side: PT logo/avatar placeholder with upload control.  
  - Right side: PT identity fields.  
- Core PT fields (minimum):  
  - Kode PT * (unique)  
  - Nama PT *  
  - Email PT *  
  - No. Telepon PT *  
  - Alamat PT * (text area)  
- Admin Primary block:  
  - Nama Admin Primary *  
  - Email Admin Primary *  
  - No. Telepon Admin Primary *  
- At bottom:  
  - “Batal” (secondary) button.  
  - “Simpan” (primary red) button.  

**Validation & Feedback**
- All `*` fields required.  
- Kode PT must be unique and may follow agreed format (e.g., prefix + running number).  
- Email fields in valid email format and unique in their respective context.  
- Phone fields follow phone validation rules.  
- Inline error messages appear under invalid fields on submit.  
- Success: show success modal/toast (“Sukses! Data PT berhasil disimpan”) with close button.  
- Cancel with unsaved changes opens confirm modal (“Apakah Anda Yakin?”).  

### Data & Behavior Requirements
- On submit, frontend sends PT payload:  
  - PT identity fields.  
  - Admin Primary data (may be used to create/link Admin PT user).  
  - Optional PT logo file.  
- Backend creates PT entity (and possibly Admin PT user) transactionally.  
- On success, user is redirected either:  
  - Back to Master PT list, or  
  - To PT Detail view (FR‑014), depending on UX decision.  
- Backend errors (duplicate code/email, validation fail) returned with specific messages mapped to form.  

### Security & Business Rules
- Only Super Admin Owner can create PT unless business rules extend this.  
- A PT must have exactly one Admin Primary at creation time, or rules for creating later must be defined.  
- No hard delete—PTs can later be deactivated but remain in database.  

### Acceptance Criteria
- “Tambah Data” opens a form that visually matches Figma’s Data PT screen.  
- Submitting valid data creates a PT and shows success message, then list/detail updates accordingly.  
- Invalid input prevents save and shows clear field-level errors.  
- Cancel with unsaved data triggers confirmation before leaving.  

---

## FR‑014 View PT Detail

**Feature Name:** PT Detail View  

### Description  
The system provides a detail view for a PT that shows PT identity, logo, contact information, and Admin Primary data, using the Figma PT detail screen layout.  

### Actor  
- Super Admin (Owner)  
- Super Admin  

### Priority  
Medium  

### Preconditions
- User is on Master PT list and selects “Detail” from a row’s Action menu; or  
- User navigates directly to PT detail URL with valid PT ID.  

### Postconditions
- PT information is displayed in read-only mode.  
- User can navigate to Edit PT or back to Master PT list.  

### UI & Interaction Requirements
- Page header title: PT name (e.g., “PT Gadai Top Indonesia”).  
- Buttons at top-right:  
  - “Edit” (primary) to open Edit PT form (FR‑015).  
  - “Kembali” or other navigation back to list.  
- Main card: “Data PT” showing at minimum:  
  - PT logo.  
  - Kode PT.  
  - Nama PT.  
  - Alamat PT.  
  - Email PT.  
  - No. Telepon PT.  
- Admin Primary section inside the card with:  
  - Nama Admin Primary.  
  - Email Admin Primary.  
  - No. Telepon Admin Primary.  

### Data & Behavior Requirements
- On load, system fetches PT by ID with associated Admin Primary data.  
- If PT is not found (deleted/invalid ID), show “Data PT tidak ditemukan” with link back to list.  
- Any changes in Edit (FR‑015) should reflect when returning to this screen.  

### Security & Business Rules
- Only authorized users may view PT detail.  
- No sensitive system-level data shown (e.g., internal IDs beyond what is needed).  

### Acceptance Criteria
- Selecting “Detail” in the Action menu opens PT detail page matching Figma (logo, PT info, Admin Primary info, Edit button).  
- Invalid PT ID shows clear error and way back to Master PT list.  
- “Edit” button navigates to Edit PT form.  

---

## FR‑015 Update PT (Edit Data PT)

**Feature Name:** Edit PT  

### Description  
The system provides an Edit PT form to modify PT identity and Admin Primary data using the Figma “Edit Data / Data PT” layout, which is similar to Tambah Data but prefilled with existing values.  

### Actor  
- Super Admin (Owner)  

### Priority  
High  

### Preconditions
- User is authorized to modify PT data.  
- Valid PT ID exists.  

### Postconditions
- PT data is updated in database with new values.  
- Master PT list and PT detail view show updated information.  

### UI & Interaction Requirements
- Page header: “Edit Data” and PT name.  
- Layout identical to Tambah Data PT:  
  - PT logo/avatar on left (can be changed).  
  - PT fields on right, prefilled.  
  - Admin Primary block fields prefilled.  
- Buttons at bottom: “Batal” and “Simpan”.  
- “Batal” with unsaved changes opens “Apakah Anda Yakin?” modal.  
- “Simpan” triggers validation and update.  

### Data & Behavior Requirements
- On load, fetch PT data and populate fields.  
- Validation rules same as Create PT (FR‑013): uniqueness of Kode PT (excluding self), email format, phone format.  
- Changing Admin Primary data updates the primary admin record or mapping according to backend design.  
- After successful save, redirect either to PT detail or Master PT list.  

### Security & Business Rules
- Only Super Admin Owner (or roles permitted) may edit PT.  
- Some fields (e.g., Kode PT) might be locked from editing based on policy; if so, they appear disabled.  
- Changes should be audit-logged (before/after for key fields).  

### Acceptance Criteria
- Edit PT form loads with all fields prefilled and matches Figma layout.  
- Valid changes are saved, success message shown, and list/detail updated.  
- Invalid input shows clear inline errors and prevents save.  
- Cancel with unsaved changes triggers confirmation; proceeding discards edits and navigates back.  

---

## FR‑016 Delete PT (Single & Bulk)

**Feature Name:** Delete PT (Single & Bulk)  

### Description  
The system allows Super Admin Owner to delete (soft-delete) one or multiple PT records from Master PT using single-row Delete and bulk selection, with confirmation and success states as shown in Figma.  

### Actor  
- Super Admin (Owner)  

### Priority  
High  

### Preconditions
- User is on Master PT page with at least one PT record.  
- Business constraints regarding PT deletion (e.g., cannot delete PT with active branches or loans) are defined at backend level.  

### Postconditions
- Allowed PT records are soft-deleted / marked inactive and removed from default Master PT list view.  
- Deletion events are recorded in audit logs.  

### UI & Interaction Requirements

**Single Delete**
- User opens Action menu for a PT row and selects “Delete”.  
- Confirmation modal appears:  
  - Title like “Apakah Anda Yakin?”.  
  - Message explains that the PT and its related access will be disabled.  
  - Buttons: “Batal” and “Hapus”.  
- On confirm:  
  - Request sent to backend.  
  - On success, row removed and success modal/toast displayed.  

**Bulk Delete**
- User selects multiple PT rows via checkboxes.  
- Indicator above table shows “X selected” with “Delete” button.  
- Clicking “Delete” opens confirmation modal mentioning number of PTs.  
- On success, all deletable PTs are removed from view; failures are reported.  

**Error Handling**
- If backend rejects deletion for some PTs (e.g., still has active cabang/transaksi), UI displays which PTs failed and why, while others succeed.  

### Data & Behavior Requirements
- Deletion implemented as soft delete or status flag; data remains in database.  
- After deletion, table reloads or updates its data and pagination/summary.  

### Security & Business Rules
- Only Super Admin Owner can perform PT deletion.  
- PT with critical dependencies may be blocked from deletion; backend enforces rules.  
- All delete operations (single or bulk) logged with actor, PT IDs, and timestamp.  

### Acceptance Criteria
- Single “Delete” from Action menu shows confirmation and, on confirm, removes the selected PT from list with success feedback.  
- Bulk delete with selected PTs shows confirmation and removes all allowed PTs, reporting any failures.  
- After deletions, “Showing X to Y of Z results” and pagination reflect the new counts.  
- Verification confirms that PTs are soft-deleted/inactive, not hard-deleted, in persistence layer.  
